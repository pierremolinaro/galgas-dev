%!TEX encoding = UTF-8 Unicode
%!TEX root = ../galgas-book.tex

%--------------------------------------------------------------
\chapter{Utilisation}
%-------------------------------------------------------------


\section{Options de la ligne de commande}\index{Options de la ligne de commande}

GALGAS accepte un certain nombre d’options, qui sont détaillées dans les pages suivantes.

L’analyse des arguments de la ligne de commandes est simple :
\begin{itemize}
  \item tout argument qui commence par un « - » est une option ;
  \item tout argument qui ne commence pas par un « - » est considéré comme un fichier source Piccolo ;
  \item les extensions acceptables par le compilateur GALGAS sont :
  \begin{itemize}
    \item « \texttt{.galgas} », un fichier source ;
    \item « \texttt{.galgasProject} », un fichier de description de projet ;
    \item « \texttt{.galgasTemplate} », un fichier de description de template.
  \end{itemize}
\end{itemize}

L’ordre des options et des fichiers sources est quelconque. La ligne de commande est complètement analysée avant le traitement des fichiers sources. Si plusieurs fichiers sources apparaissent dans la ligne de commande, ils sont traités dans leur ordre d’apparition.

{\bf Note pour Windows.} L’outil GALGAS pour Windows propose par défaut un dialogue invitant à entrer les références d’un fichier source si la ligne ne contient aucun fichier source (c’est le cas quand on double-clique sur l’icône de l’application). Une option « \texttt{-{-}no-dialog} », spécifique à cette plate forme, permet d'inhiber l’apparition du dialogue.

\subsection{Options générales}

\begin{description}
  \item[\texttt{-{-}help}] Affiche la liste des options.

  \item[\texttt{-{-}version}] Affiche le numéro de version.

  \item[\texttt{-{-}no-color}] Les messages émis sur le terminal sont en texte pur, sans coloration.

  \item[\texttt{-{-}no-dialog}] (\emph{uniquement sur Windows}) L’outil Piccolo pour Windows propose par défaut un dialogue invitant à entrer les références d’un fichier source si la ligne ne contient aucun fichier source (c’est le cas quand on double-clique sur l’icône de l’application). Cette option permet d'inhiber l’apparition du dialogue.
\end{description}


\subsectionLabel{Options \emph{quiet} et \emph{verbose}}{optionsQuietVerbose}


\begin{description}
  \item[\texttt{-v}, \texttt{-{-}verbose}] Affiche des messages complémentaires sur le terminal. Par défaut, quand toutes les étapes se déroulent correctement, aucun message n’est affiché.
  \item[\texttt{-q}, \texttt{-{-}quiet}] N'affiche aucun message complémentaire sur le terminal. Par défaut, des messages complémentaires sur le terminal sont affichés.
\end{description}

Ces deux options s'excluent, c'est-à-dire qu'un exécutable définit soit l'option \emph{quiet}, soit l'option \emph{verbose}, mais par les deux :
\begin{itemize}
  \item le compilateur GALGAS implémente l'option \emph{quiet}, mais pas l'option \emph{verbose} ;
  \item par défaut, un compilateur engendré par GALGAS implémente l'option \emph{quiet}, mais pas l'option \emph{verbose} ;
  \item Si la déclaration \ggs!%quietOutputByDefault!\index{\%quietOutputByDefault} parmi les déclarations du fichier projet (voir \refSectionPage{projetDeclarationQuietOutputByDefault}), le compilateur engendré par GALGAS implémente l'option \emph{verbose}, mais pas l'option \emph{quiet}.
\end{itemize}





\subsection{Option de création d'un projet}

\begin{description}

  \item[\texttt{-{-}create-project=$nom$}] Crée un nouveau projet GALGAS nommé $nom$ dans le répertoire courant.

\end{description}



\subsection{Options contrôlant le compilateur}




\begin{description}

  \item[\texttt{-W}, \texttt{-{-}Werror}] Tout \emph{warning} est considéré comme une erreur. Cela peut être important dans un script, l’outil de commande renvoyant un code non nul si une ou plusieurs erreurs ont été détectées.

  \item[\texttt{-{-}max-errors=\emph{n}}] Stoppe après \emph{n} erreurs.

  \item[\texttt{-{-}max-warnings=\emph{n}}] Stoppe après \emph{n} alertes.

\end{description}



\subsectionLabel{Options contrôlant la génération de fichiers}{optionsGeneration}


\begin{description}

  \item[\texttt{-{-}log-f{}ile-read}] Affiche sur la console tout accès en lecture à un fichier.


  \item[\texttt{-{-}no-f{}ile-generation}] Inhibe l'écriture de tout fichier.


  \item[\texttt{-{-}mode=$nom$}] Contrôle l'opération du compilateur : si $nom$ est vide, le compilateur opère normalement. Si $nom$ est \texttt{lexical-only}, le compilateur affiche le résultat de l'analyse lexicale et s'arrête ; aucun fichier n'est engendré. Si $nom$ est \texttt{syntax-only}, le compilateur affiche le résultat de l'analyse syntaxique et s'arrête ; aucun fichier n'est engendré.



  \item[\texttt{-{-}generate-shared-map-automaton-dot-f{}iles}] Exporte les automates d'états finis associés à chaque table de symboles de type \ggs!sharedmap!. Les fichiers de sortie sont placés dans le répertoire \texttt{build/helpers}, et portent le nom du type table postfixé par l'extension \texttt{.dot}.




  \item[\texttt{-{-}print-predefined-lexical-actions}] Affiche sur la console la liste des routines lexicales prédéfinies.


  \item[\texttt{-{-}generate-shared-map-automaton-dot-files}] Exporte les automates d'états finis associés à chaque table de symboles de type \ggs!sharedmap!. Les fichiers de sortie sont placés dans le répertoire \texttt{build/helpers}, et portent le nom du type table postfixé par l'extension \texttt{.dot}.





  \item[\texttt{-{-}output-concrete-syntax-tree}] Exporte dans un fichier l'arbre syntaxique concret du code source analysé sous la forme d'un graphe dont le format est compatible avec \emph{Graphviz}. Le nom du fichier de sortie est le nom du fichier source doté de l'extension complémentaire \texttt{.dot}.


  \item[\texttt{-{-}compile=$nom$}] Enchaîne une compilation C++ après une compilation GALGAS sans erreur. Le $nom$ est le nom d'une cible de type \emph{makefile} ; par exemple, \texttt{-{-}compile=makefile-macosx} enchaîne la compilation C++ de la cible \emph{makefile-macosx}.




\subsection{Options de débogage du compilateur}

Ces options ne sont pas destinées à être utilisées lors de l'exploitation de GALGAS : elles permettent de déboguer le compilateur lui-même, et non pas le fichier source compilé.


  \item[\texttt{-{-}trace}] Émet un fichier de trace de du compilateur. Format non documenté, utile uniquement pour déboguer le compilateur lui-même.


  \item[\texttt{-{-}generate-many-cpp-files}] Engendre le code C++ dans une multitude de fichiers. Ceci permet un débogage plus simple du compilateur GALGAS lui-même, mais ralentit ensuite l'étape de compilation C++.


  \item[\texttt{-{-}generate-one-cpp-header}] Engendre un seule fichier d'en-tête C++ pour tout le projet. Ceci permet un débogage plus simple du compilateur GALGAS lui-même, mais ralentit ensuite l'étape de compilation C++.


  \item[\texttt{-{-}check-gmp}] Exécute au démarrage une série de calculs afin de vérifier si la librairie GMP est correctement compilée.

\end{description}

