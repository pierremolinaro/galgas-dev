#---------------------------------------------------------------------------*
#                                                                           *
#  GALGAS grammar start symbol definition                                   *
#                                                                           *
#  Copyright (C) 1997, ..., 2007 Pierre Molinaro.                           *
#  e-mail : molinaro@irccyn.ec-nantes.fr                                    *
#                                                                           *
#  This program is free software; you can redistribute it and/or modify it  *
#  under the terms of the GNU General Public License as published by the    *
#  Free Software Foundation.                                                *
#                                                                           *
#  This program is distributed in the hope it will be useful, but WITHOUT   *
#  ANY WARRANTY; without even the implied warranty of MERCHANDIBILITY or    *
#  FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for *
#   more details.                                                           *
#                                                                           *
#---------------------------------------------------------------------------*

syntax galgas_start :

import lexique galgas_scanner in "galgas_scanner.gLexique" ;
import option galgas_cli_options in "galgas_cli_options.gOption" ;

import semantics semantics_semantics in "semantics_semantics.gSemantics" ;

#------------------------------------------------------------------------------*
#                                                                              *
#          Production rules declaration                                        *
#                                                                              *
#------------------------------------------------------------------------------*

nonterminal <galgas_start_symbol>
  ?!@M_lexiqueComponents ioLexiqueMapForUse
  ?!@M_semanticsComponents ioSemanticsComponentsMap
  ?!@M_syntaxComponents ioSyntaxComponentsMap
  ?!@M_grammarComponents ioGrammarComponentsMap
  ?!@M_optionComponents ioOptionsComponentsMap
  ?!@EXsemanticContext unused ioSemanticContext
label importLexique
  ?!@M_lexiqueComponents ioLexiqueMapForUse
label importSyntax
  ?!@M_syntaxComponents ioSyntaxComponentsMap
  ?!@EXsemanticContext unused ioSemanticContext
label importSemantics
  ?!@M_semanticsComponents ioSemanticsComponentsMap
  ?!@EXsemanticContext unused ioSemanticContext
  ?!@stringset unused ioImportedSemanticsComponentNameSet
label importGrammarForSemantics
  ?!@M_grammarComponents ioGrammarComponentsMap
  ?!@M_optionComponents ioOptionsComponentsMapForUse
  ?!@EXsemanticContext unused ioSemanticContext
label importOptions
  ?!@M_optionComponents ioOptionsComponentsMap
label compileFile
;

nonterminal <galgas_component>
  ?!@M_lexiqueComponents ioLexiqueMapForUse
  ?!@M_semanticsComponents ioSemanticsComponentsMap
  ?!@M_syntaxComponents ioSyntaxComponentsMap
  ?!@M_grammarComponents ioGrammarComponentsMap
  ?!@M_optionComponents ioOptionsComponentsMap
  ?!@EXsemanticContext unused ioSemanticContext
label importLexique
  ?!@M_lexiqueComponents ioLexiqueMapForUse
label importSyntax
  ?!@M_syntaxComponents ioSyntaxComponentsMap
  ?!@EXsemanticContext unused ioSemanticContext
label importSemantics
  ?!@M_semanticsComponents ioSemanticsComponentsMap
  ?!@EXsemanticContext unused ioSemanticContext
  ?!@stringset ioImportedSemanticsComponentNameSet
label importGrammarForSemantics
  ?!@M_grammarComponents ioGrammarComponentsMap
  ?!@M_optionComponents ioOptionsComponentsMap
  ?!@EXsemanticContext unused ioSemanticContext
label importOptions
  ?!@M_optionComponents ioOptionsComponentsMap
;

#------------------------------------------------------------------------------*

rule <galgas_start_symbol>
  ?!@M_lexiqueComponents ioLexiqueMapForUse
  ?!@M_semanticsComponents ioSemanticsComponentsMap
  ?!@M_syntaxComponents ioSyntaxComponentsMap
  ?!@M_grammarComponents ioGrammarComponentsMap
  ?!@M_optionComponents ioOptionsComponentsMap
  ?!@EXsemanticContext ioSemanticContext
:
  repeat
  while
    <galgas_component>
      !?ioLexiqueMapForUse
      !?ioSemanticsComponentsMap
      !?ioSyntaxComponentsMap
      !?ioGrammarComponentsMap
      !?ioOptionsComponentsMap
      !?ioSemanticContext
    ;
  end repeat ;
label importLexique
  ?!@M_lexiqueComponents ioLexiqueMapForUse
:
  repeat
  while
    <galgas_component> importLexique !?ioLexiqueMapForUse ;
  end repeat ;
label importSyntax
  ?!@M_syntaxComponents ioSyntaxComponentsMap
  ?!@EXsemanticContext ioSemanticContext
:
  repeat
  while
    <galgas_component> importSyntax
      !?ioSyntaxComponentsMap
      !?ioSemanticContext
    ;
  end repeat ;
label importSemantics
  ?!@M_semanticsComponents ioSemanticsComponentsMap
  ?!@EXsemanticContext ioSemanticContext
  ?!@stringset ioImportedSemanticsComponentNameSet
:
  repeat
  while
    <galgas_component> importSemantics
      !?ioSemanticsComponentsMap
      !?ioSemanticContext
      !?ioImportedSemanticsComponentNameSet
    ;
  end repeat ;
label importGrammarForSemantics
  ?!@M_grammarComponents ioGrammarComponentsMap
  ?!@M_optionComponents ioOptionsComponentsMapForUse
  ?!@EXsemanticContext ioSemanticContext
:
  repeat
  while
    <galgas_component> importGrammarForSemantics
      !?ioGrammarComponentsMap
      !?ioOptionsComponentsMapForUse
      !?ioSemanticContext
    ;
  end repeat ;
label compileFile
:
  @M_lexiqueComponents lexiqueMapForUse [emptyMap] ;
  @M_semanticsComponents semanticsComponentsMap [emptyMap] ;
  @M_syntaxComponents syntaxComponentsMap [emptyMap] ;
  @M_grammarComponents grammarComponentsMap [emptyMap] ;
  @M_optionComponents optionsComponentsMap [emptyMap] ;
  @EXsemanticContext semanticContext [new
    ![@M_filewrappers emptyMap]
    ![@stringset emptySet]
    ![@EXcategoryMethodMap emptyMap]
  ] ;
  repeat
  while
    <galgas_component>
      !?lexiqueMapForUse
      !?semanticsComponentsMap
      !?syntaxComponentsMap
      !?grammarComponentsMap
      !?optionsComponentsMap
      !?semanticContext
    ;
  end repeat ;
label importOptions
  ?!@M_optionComponents ioOptionsComponentsMap
:
  repeat
  while
    <galgas_component> importOptions !?ioOptionsComponentsMap ;
  end repeat ;
end rule ;

#------------------------------------------------------------------------------*

end syntax ;
