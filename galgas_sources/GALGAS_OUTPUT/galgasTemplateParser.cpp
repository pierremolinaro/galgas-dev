//---------------------------------------------------------------------------*
//                                                                           *
//                     File 'galgasTemplateParser.cpp'                       *
//                 Generated by version GALGAS_BETA_VERSION                  *
//                     october 24th, 2010, at 21h31'45"                      *
//                                                                           *
//---------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

//---------------------------------------------------------------------------*

#include "version_libpm.h"
#if CURRENT_LIBPM_VERSION != VERSION_OF_LIBPM_USED_BY_GALGAS_COMPILER
  #error "This file has been compiled with a version of GALGAS that uses libpm version VERSION_OF_LIBPM_USED_BY_GALGAS_COMPILER, different than the current version (CURRENT_LIBPM_VERSION) of libpm"
#endif

//---------------------------------------------------------------------------*

#include <typeinfo>
#include "utilities/MF_MemoryControl.h"
#include "files/C_TextFileWrite.h"
#include "galgas/C_galgas_CLI_Options.h"
#include "galgasTemplateParser.h"

//---------------------------------------------------------------------------*

#ifndef DO_NOT_GENERATE_CHECKINGS
  #define SOURCE_FILE_AT_LINE(line) "galgasTemplateParser.gSyntax", line
  #define COMMA_SOURCE_FILE_AT_LINE(line) , SOURCE_FILE_AT_LINE(line)
#else
  #define SOURCE_FILE_AT_LINE(line) 
  #define COMMA_SOURCE_FILE_AT_LINE(line) 
#endif


//--- START OF USER ZONE 2


//--- END OF USER ZONE 2

//---------------------------------------------------------------------------*
//                                                                           *
//            Implementation of routine "enterTemplateStringEX"              *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_enterTemplateStringEX (C_Compiler & inLexique,
                                GGS_templateInstructionList  & var_cas_outResultingInstructionList
                        COMMA_UNUSED_LOCATION_ARGS) {
  #ifdef DEBUG_TRACE_ENABLED
    printf ("ENTER routine_enterTemplateStringEX at %s:%d\n", __FILE__, __LINE__) ;
  #endif
  GGS_lstring  var_cas_s = GGS_lstring ::constructor_retrieveAndResetTemplateString (inLexique COMMA_SOURCE_FILE_AT_LINE (58)) ;
  const GGS_bool cond_2911 = (var_cas_s.ggs_string ().reader_length ()).operator_strictSup (GGS_uint (0U)) ;
  if (cond_2911.isBuiltAndTrue ()) {
    var_cas_outResultingInstructionList.addAssign_operation (GGS_templateInstructionString ::constructor_new (inLexique, var_cas_s.reader_string (inLexique COMMA_SOURCE_FILE_AT_LINE (60)) COMMA_SOURCE_FILE_AT_LINE (60))) ;
  }
  #ifdef DEBUG_TRACE_ENABLED
    printf ("LEAVE routine_enterTemplateStringEX\n") ;
  #endif
}

//---------------------------------------------------------------------------*
//                                                                           *
//         Implementation of production rule 'template_instruction'          *
//                                                                           *
//---------------------------------------------------------------------------*

void galgasTemplateParser::rule_galgasTemplateParser_template_5F_instruction_i0_ (C_Lexique_galgasTemplateScanner & inLexique,
                                GGS_templateVariableMap  &var_cas_ioTemplateVariableMap,
                                const GGS_EXsemanticContext var_cas_inSemanticContext,
                                const GGS_M_semanticsEntitiesForUse  var_cas_inComponentSemanticsEntitiesMap,
                                const GGS_M_optionComponents  var_cas_inOptionsComponentsMapForUse,
                                GGS_templateInstructionList  &var_cas_ioResultingInstructionList,
                                GGS_bool &/* var_cas_ioUsesColumnMarker */) {
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken__21_) COMMA_HERE) ;
  GGS_typeExpression  var_cas_expression ;
  GGS_AC_galgasType  var_cas_resultType ;
  nt_expression_ (inLexique, var_cas_inComponentSemanticsEntitiesMap, var_cas_inSemanticContext, var_cas_inOptionsComponentsMapForUse, var_cas_ioTemplateVariableMap, var_cas_expression, var_cas_resultType) ;
  GGS_typeGalgas_string  var_cas_x = GGS_typeGalgas_string::castFrom (inLexique, var_cas_resultType.getPtr (), true, GGS_location (inLexique) COMMA_SOURCE_FILE_AT_LINE (85)) ;
  var_cas_ioResultingInstructionList.addAssign_operation (GGS_templateInstructionExpression ::constructor_new (inLexique, var_cas_expression COMMA_SOURCE_FILE_AT_LINE (86))) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//         Implementation of production rule 'template_instruction'          *
//                                                                           *
//---------------------------------------------------------------------------*

void galgasTemplateParser::rule_galgasTemplateParser_template_5F_instruction_i1_ (C_Lexique_galgasTemplateScanner & inLexique,
                                GGS_templateVariableMap  &var_cas_ioTemplateVariableMap,
                                const GGS_EXsemanticContext /* var_cas_inSemanticContext */,
                                const GGS_M_semanticsEntitiesForUse  /* var_cas_inComponentSemanticsEntitiesMap */,
                                const GGS_M_optionComponents  /* var_cas_inOptionsComponentsMapForUse */,
                                GGS_templateInstructionList  &var_cas_ioResultingInstructionList,
                                GGS_bool &/* var_cas_ioUsesColumnMarker */) {
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken__3F_) COMMA_HERE) ;
  GGS_lstring  var_cas_columnConstantName ;
  inLexique.assignFromAttribute_tokenString (var_cas_columnConstantName) ;
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_identifier) COMMA_HERE) ;
  GGS_typeCplusPlusName  var_cas_cppName = GGS_typeAutomaticName ::constructor_new (inLexique, var_cas_columnConstantName.reader_location (inLexique COMMA_SOURCE_FILE_AT_LINE (102)), var_cas_columnConstantName.reader_string (inLexique COMMA_SOURCE_FILE_AT_LINE (102)) COMMA_SOURCE_FILE_AT_LINE (102)) ;
  var_cas_ioTemplateVariableMap.modifier_insertKey (inLexique, var_cas_columnConstantName, GGS_typeGalgas_string ::constructor_new (inLexique COMMA_SOURCE_FILE_AT_LINE (105)), var_cas_cppName COMMA_SOURCE_FILE_AT_LINE (103)) ;
  var_cas_ioResultingInstructionList.addAssign_operation (GGS_templateInstructionColumnString ::constructor_new (inLexique, var_cas_cppName COMMA_SOURCE_FILE_AT_LINE (108))) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//         Implementation of production rule 'template_instruction'          *
//                                                                           *
//---------------------------------------------------------------------------*

void galgasTemplateParser::rule_galgasTemplateParser_template_5F_instruction_i2_ (C_Lexique_galgasTemplateScanner & inLexique,
                                GGS_templateVariableMap  &/* var_cas_ioTemplateVariableMap */,
                                const GGS_EXsemanticContext /* var_cas_inSemanticContext */,
                                const GGS_M_semanticsEntitiesForUse  /* var_cas_inComponentSemanticsEntitiesMap */,
                                const GGS_M_optionComponents  /* var_cas_inOptionsComponentsMapForUse */,
                                GGS_templateInstructionList  &var_cas_ioResultingInstructionList,
                                GGS_bool &var_cas_ioUsesColumnMarker) {
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken__3F__5E_) COMMA_HERE) ;
  var_cas_ioResultingInstructionList.addAssign_operation (GGS_templateInstructionGetColumnLocation ::constructor_new (inLexique COMMA_SOURCE_FILE_AT_LINE (122))) ;
  var_cas_ioUsesColumnMarker = GGS_bool (true) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//         Implementation of production rule 'template_instruction'          *
//                                                                           *
//---------------------------------------------------------------------------*

void galgasTemplateParser::rule_galgasTemplateParser_template_5F_instruction_i3_ (C_Lexique_galgasTemplateScanner & inLexique,
                                GGS_templateVariableMap  &/* var_cas_ioTemplateVariableMap */,
                                const GGS_EXsemanticContext /* var_cas_inSemanticContext */,
                                const GGS_M_semanticsEntitiesForUse  /* var_cas_inComponentSemanticsEntitiesMap */,
                                const GGS_M_optionComponents  /* var_cas_inOptionsComponentsMapForUse */,
                                GGS_templateInstructionList  &var_cas_ioResultingInstructionList,
                                GGS_bool &var_cas_ioUsesColumnMarker) {
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken__21__5E_) COMMA_HERE) ;
  var_cas_ioResultingInstructionList.addAssign_operation (GGS_templateInstructionGotoColumnLocation ::constructor_new (inLexique COMMA_SOURCE_FILE_AT_LINE (137))) ;
  var_cas_ioUsesColumnMarker = GGS_bool (true) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//         Implementation of production rule 'template_instruction'          *
//                                                                           *
//---------------------------------------------------------------------------*

void galgasTemplateParser::rule_galgasTemplateParser_template_5F_instruction_i4_ (C_Lexique_galgasTemplateScanner & inLexique,
                                GGS_templateVariableMap  &var_cas_ioTemplateVariableMap,
                                const GGS_EXsemanticContext var_cas_inSemanticContext,
                                const GGS_M_semanticsEntitiesForUse  var_cas_inComponentSemanticsEntitiesMap,
                                const GGS_M_optionComponents  var_cas_inOptionsComponentsMapForUse,
                                GGS_templateInstructionList  &var_cas_ioResultingInstructionList,
                                GGS_bool &var_cas_ioUsesColumnMarker) {
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_block) COMMA_HERE) ;
  GGS_typeExpression  var_cas_expression ;
  GGS_AC_galgasType  var_cas_resultType ;
  nt_expression_ (inLexique, var_cas_inComponentSemanticsEntitiesMap, var_cas_inSemanticContext, var_cas_inOptionsComponentsMapForUse, var_cas_ioTemplateVariableMap, var_cas_expression, var_cas_resultType) ;
  GGS_typeGalgas_uint  var_cas_x = GGS_typeGalgas_uint::castFrom (inLexique, var_cas_resultType.getPtr (), true, GGS_location (inLexique) COMMA_SOURCE_FILE_AT_LINE (162)) ;
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken__3A_) COMMA_HERE) ;
  GGS_templateInstructionList  var_cas_blockInstructionList = GGS_templateInstructionList ::constructor_emptyList () ;
  ::routine_enterTemplateStringEX (inLexique,  var_cas_blockInstructionList COMMA_SOURCE_FILE_AT_LINE (166)) ;
  GGS_templateVariableMap  var_cas_templateVariableMap = var_cas_ioTemplateVariableMap ;
  { bool syntaxRepeat_0 = true ;
    while (syntaxRepeat_0) {
      switch (select_galgasTemplateParser_0 (inLexique)) {
        case 2 : {
          nt_template_5F_instruction_ (inLexique, var_cas_templateVariableMap, var_cas_inSemanticContext, var_cas_inComponentSemanticsEntitiesMap, var_cas_inOptionsComponentsMapForUse, var_cas_blockInstructionList, var_cas_ioUsesColumnMarker) ;
          ::routine_enterTemplateStringEX (inLexique,  var_cas_blockInstructionList COMMA_SOURCE_FILE_AT_LINE (178)) ;
          } break ;
        default :
          syntaxRepeat_0 = false ;
          break ;
      }
    }
  }
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_end) COMMA_HERE) ;
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_block) COMMA_HERE) ;
  var_cas_ioResultingInstructionList.addAssign_operation (GGS_templateBlockInstruction ::constructor_new (inLexique, var_cas_expression, GGS_location (inLexique), var_cas_blockInstructionList COMMA_SOURCE_FILE_AT_LINE (183))) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//         Implementation of production rule 'template_instruction'          *
//                                                                           *
//---------------------------------------------------------------------------*

void galgasTemplateParser::rule_galgasTemplateParser_template_5F_instruction_i5_ (C_Lexique_galgasTemplateScanner & inLexique,
                                GGS_templateVariableMap  &var_cas_ioTemplateVariableMap,
                                const GGS_EXsemanticContext var_cas_inSemanticContext,
                                const GGS_M_semanticsEntitiesForUse  var_cas_inComponentSemanticsEntitiesMap,
                                const GGS_M_optionComponents  var_cas_inOptionsComponentsMapForUse,
                                GGS_templateInstructionList  &var_cas_ioResultingInstructionList,
                                GGS_bool &var_cas_ioUsesColumnMarker) {
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_foreach) COMMA_HERE) ;
  GGS_bool var_cas_ascending ;
  switch (select_galgasTemplateParser_1 (inLexique)) {
    case 1 : {
      var_cas_ascending = GGS_bool (true) ;
      } break ;
    case 2 : {
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken__3C_) COMMA_HERE) ;
      var_cas_ascending = GGS_bool (true) ;
      } break ;
    case 3 : {
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken__3E_) COMMA_HERE) ;
      var_cas_ascending = GGS_bool (false) ;
      } break ;
    default :
      break ;
  }
  GGS_typeExpression  var_cas_expression ;
  GGS_AC_galgasType  var_cas_expressionType ;
  nt_expression_ (inLexique, var_cas_inComponentSemanticsEntitiesMap, var_cas_inSemanticContext, var_cas_inOptionsComponentsMapForUse, var_cas_ioTemplateVariableMap, var_cas_expression, var_cas_expressionType) ;
  GGS_string var_cas_foreachPrefix ;
  switch (select_galgasTemplateParser_2 (inLexique)) {
    case 1 : {
      var_cas_foreachPrefix = GGS_string ("") ;
      } break ;
    case 2 : {
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_prefixedby) COMMA_HERE) ;
      GGS_lstring  var_cas_prefixString ;
      inLexique.assignFromAttribute_tokenString (var_cas_prefixString) ;
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_identifier) COMMA_HERE) ;
      var_cas_foreachPrefix = var_cas_prefixString.reader_string (inLexique COMMA_SOURCE_FILE_AT_LINE (227)) ;
      } break ;
    default :
      break ;
  }
  GGS_string var_cas_cppExpressionTypeName ;
  if (var_cas_expressionType.isBuilt ()) {
    var_cas_expressionType (HERE)->method_getTypeName (inLexique, var_cas_cppExpressionTypeName COMMA_SOURCE_FILE_AT_LINE (231)) ;
  }
  GGS_location  var_cas_instructionLocation = GGS_location (inLexique) ;
  GGS_typeListeAttributsSemantiques  var_cas_formalEnumerationList ;
  GGS_localConstantBuildStyleEnum var_cas_localConstantBuildStyleEnum ;
  GGS_bool var_cas_iteratorNewStyle ;
  if (var_cas_expressionType.isBuilt ()) {
    var_cas_expressionType (HERE)->method_acceptForeachInstruction (inLexique, var_cas_inComponentSemanticsEntitiesMap, var_cas_instructionLocation, var_cas_formalEnumerationList, var_cas_localConstantBuildStyleEnum, var_cas_iteratorNewStyle COMMA_SOURCE_FILE_AT_LINE (237)) ;
  }
  GGS_templateInstructionList  var_cas_beforeInstructionList = GGS_templateInstructionList ::constructor_emptyList () ;
  switch (select_galgasTemplateParser_3 (inLexique)) {
    case 1 : {
      } break ;
    case 2 : {
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_before) COMMA_HERE) ;
      ::routine_enterTemplateStringEX (inLexique,  var_cas_beforeInstructionList COMMA_SOURCE_FILE_AT_LINE (249)) ;
      GGS_templateVariableMap  var_cas_templateVariableMap = var_cas_ioTemplateVariableMap ;
      { bool syntaxRepeat_4 = true ;
        while (syntaxRepeat_4) {
          switch (select_galgasTemplateParser_4 (inLexique)) {
            case 2 : {
              nt_template_5F_instruction_ (inLexique, var_cas_templateVariableMap, var_cas_inSemanticContext, var_cas_inComponentSemanticsEntitiesMap, var_cas_inOptionsComponentsMapForUse, var_cas_beforeInstructionList, var_cas_ioUsesColumnMarker) ;
              ::routine_enterTemplateStringEX (inLexique,  var_cas_beforeInstructionList COMMA_SOURCE_FILE_AT_LINE (261)) ;
              } break ;
            default :
              syntaxRepeat_4 = false ;
              break ;
          }
        }
      }
      } break ;
    default :
      break ;
  }
  GGS_templateVariableMap  var_cas_templateVariableMap = var_cas_ioTemplateVariableMap ;
  GGS_bool var_cas_mapStyle = (var_cas_localConstantBuildStyleEnum).operator_isNotEqual (GGS_localConstantBuildStyleEnum::constructor_listStyle (inLexique COMMA_SOURCE_FILE_AT_LINE (267))) ;
  GGS_bool var_cas_firstOne = GGS_bool (true) ;
  {
    GGS_typeListeAttributsSemantiques::cEnumerator enumerator_9452 (var_cas_formalEnumerationList, true) ;
    const GGS_typeListeAttributsSemantiques::cElement * operand_9452 = NULL ;
    while (((operand_9452 = enumerator_9452.nextObject ()))) {
      macroValidPointer (operand_9452) ;
      GGS_typeCplusPlusName  var_cas_cppName ;
      const GGS_bool cond_9685 = ((var_cas_localConstantBuildStyleEnum).operator_isEqual (GGS_localConstantBuildStyleEnum::constructor_firstIsKeyOtherMapStyle (inLexique COMMA_SOURCE_FILE_AT_LINE (271)))).operator_and (var_cas_firstOne) ;
      if (cond_9685.isBuiltAndTrue ()) {
        var_cas_cppName = GGS_typeKeyName ::constructor_new (inLexique, var_cas_instructionLocation, var_cas_iteratorNewStyle COMMA_SOURCE_FILE_AT_LINE (272)) ;
      }else if (cond_9685.isBuiltAndFalse ()) {
        var_cas_cppName = GGS_typeOperandName ::constructor_new (inLexique, var_cas_instructionLocation, operand_9452->mAttributeName.reader_string (inLexique COMMA_SOURCE_FILE_AT_LINE (274)), var_cas_mapStyle, var_cas_iteratorNewStyle COMMA_SOURCE_FILE_AT_LINE (274)) ;
      }
      GGS_lstring  var_cas_implicitVariableName = GGS_lstring ::constructor_new (inLexique, (var_cas_foreachPrefix).operator_concat (operand_9452->mAttributeName), GGS_location (inLexique) COMMA_SOURCE_FILE_AT_LINE (276)) ;
      var_cas_templateVariableMap.modifier_insertKey (inLexique, var_cas_implicitVariableName, operand_9452->mAttributType, var_cas_cppName COMMA_SOURCE_FILE_AT_LINE (277)) ;
      var_cas_firstOne = GGS_bool (false) ;
    }
  }
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_do) COMMA_HERE) ;
  GGS_lstring  var_cas_indexIdentifier ;
  switch (select_galgasTemplateParser_5 (inLexique)) {
    case 1 : {
      var_cas_indexIdentifier = GGS_lstring ::constructor_new (inLexique, GGS_string (""), GGS_location (inLexique) COMMA_SOURCE_FILE_AT_LINE (283)) ;
      } break ;
    case 2 : {
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_index) COMMA_HERE) ;
      inLexique.assignFromAttribute_tokenString (var_cas_indexIdentifier) ;
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_identifier) COMMA_HERE) ;
      GGS_typeCplusPlusName  var_cas_cppName = GGS_typeAutomaticName ::constructor_new (inLexique, var_cas_indexIdentifier.reader_location (inLexique COMMA_SOURCE_FILE_AT_LINE (287)), var_cas_indexIdentifier.reader_string (inLexique COMMA_SOURCE_FILE_AT_LINE (287)) COMMA_SOURCE_FILE_AT_LINE (287)) ;
      var_cas_templateVariableMap.modifier_insertKey (inLexique, var_cas_indexIdentifier, GGS_typeGalgas_uint ::constructor_new (inLexique COMMA_SOURCE_FILE_AT_LINE (288)), var_cas_cppName COMMA_SOURCE_FILE_AT_LINE (288)) ;
      } break ;
    default :
      break ;
  }
  GGS_templateInstructionList  var_cas_doInstructionList = GGS_templateInstructionList ::constructor_emptyList () ;
  ::routine_enterTemplateStringEX (inLexique,  var_cas_doInstructionList COMMA_SOURCE_FILE_AT_LINE (291)) ;
  { bool syntaxRepeat_6 = true ;
    while (syntaxRepeat_6) {
      switch (select_galgasTemplateParser_6 (inLexique)) {
        case 2 : {
          nt_template_5F_instruction_ (inLexique, var_cas_templateVariableMap, var_cas_inSemanticContext, var_cas_inComponentSemanticsEntitiesMap, var_cas_inOptionsComponentsMapForUse, var_cas_doInstructionList, var_cas_ioUsesColumnMarker) ;
          ::routine_enterTemplateStringEX (inLexique,  var_cas_doInstructionList COMMA_SOURCE_FILE_AT_LINE (302)) ;
          } break ;
        default :
          syntaxRepeat_6 = false ;
          break ;
      }
    }
  }
  GGS_templateInstructionList  var_cas_betweenInstructionList = GGS_templateInstructionList ::constructor_emptyList () ;
  switch (select_galgasTemplateParser_7 (inLexique)) {
    case 1 : {
      } break ;
    case 2 : {
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_between) COMMA_HERE) ;
      ::routine_enterTemplateStringEX (inLexique,  var_cas_betweenInstructionList COMMA_SOURCE_FILE_AT_LINE (309)) ;
      GGS_templateVariableMap  var_cas_templateVariableMap = var_cas_ioTemplateVariableMap ;
      { bool syntaxRepeat_8 = true ;
        while (syntaxRepeat_8) {
          switch (select_galgasTemplateParser_8 (inLexique)) {
            case 2 : {
              nt_template_5F_instruction_ (inLexique, var_cas_templateVariableMap, var_cas_inSemanticContext, var_cas_inComponentSemanticsEntitiesMap, var_cas_inOptionsComponentsMapForUse, var_cas_betweenInstructionList, var_cas_ioUsesColumnMarker) ;
              ::routine_enterTemplateStringEX (inLexique,  var_cas_betweenInstructionList COMMA_SOURCE_FILE_AT_LINE (321)) ;
              } break ;
            default :
              syntaxRepeat_8 = false ;
              break ;
          }
        }
      }
      } break ;
    default :
      break ;
  }
  GGS_templateInstructionList  var_cas_afterInstructionList = GGS_templateInstructionList ::constructor_emptyList () ;
  switch (select_galgasTemplateParser_9 (inLexique)) {
    case 1 : {
      } break ;
    case 2 : {
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_after) COMMA_HERE) ;
      ::routine_enterTemplateStringEX (inLexique,  var_cas_afterInstructionList COMMA_SOURCE_FILE_AT_LINE (329)) ;
      GGS_templateVariableMap  var_cas_templateVariableMap = var_cas_ioTemplateVariableMap ;
      { bool syntaxRepeat_10 = true ;
        while (syntaxRepeat_10) {
          switch (select_galgasTemplateParser_10 (inLexique)) {
            case 2 : {
              nt_template_5F_instruction_ (inLexique, var_cas_templateVariableMap, var_cas_inSemanticContext, var_cas_inComponentSemanticsEntitiesMap, var_cas_inOptionsComponentsMapForUse, var_cas_beforeInstructionList, var_cas_ioUsesColumnMarker) ;
              ::routine_enterTemplateStringEX (inLexique,  var_cas_afterInstructionList COMMA_SOURCE_FILE_AT_LINE (341)) ;
              } break ;
            default :
              syntaxRepeat_10 = false ;
              break ;
          }
        }
      }
      } break ;
    default :
      break ;
  }
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_end) COMMA_HERE) ;
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_foreach) COMMA_HERE) ;
  var_cas_ioResultingInstructionList.addAssign_operation (GGS_templateInstructionForeach ::constructor_new (inLexique, var_cas_ascending, var_cas_cppExpressionTypeName, var_cas_iteratorNewStyle, var_cas_expression, var_cas_instructionLocation, var_cas_beforeInstructionList, var_cas_doInstructionList, var_cas_indexIdentifier, var_cas_betweenInstructionList, var_cas_afterInstructionList COMMA_SOURCE_FILE_AT_LINE (347))) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//         Implementation of production rule 'template_instruction'          *
//                                                                           *
//---------------------------------------------------------------------------*

void galgasTemplateParser::rule_galgasTemplateParser_template_5F_instruction_i6_ (C_Lexique_galgasTemplateScanner & inLexique,
                                GGS_templateVariableMap  &var_cas_ioTemplateVariableMap,
                                const GGS_EXsemanticContext var_cas_inSemanticContext,
                                const GGS_M_semanticsEntitiesForUse  var_cas_inComponentSemanticsEntitiesMap,
                                const GGS_M_optionComponents  var_cas_inOptionsComponentsMapForUse,
                                GGS_templateInstructionList  &var_cas_ioResultingInstructionList,
                                GGS_bool &var_cas_ioUsesColumnMarker) {
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_if) COMMA_HERE) ;
  GGS_templateInstructionIfBranchList  var_cas_templateInstructionIfBranchList = GGS_templateInstructionIfBranchList ::constructor_emptyList () ;
  { bool syntaxRepeat_11 = true ;
    while (syntaxRepeat_11) {
        GGS_typeExpression  var_cas_expression ;
        GGS_AC_galgasType  var_cas_expressionType ;
        nt_expression_ (inLexique, var_cas_inComponentSemanticsEntitiesMap, var_cas_inSemanticContext, var_cas_inOptionsComponentsMapForUse, var_cas_ioTemplateVariableMap, var_cas_expression, var_cas_expressionType) ;
        GGS_typeGalgas_bool  var_cas_x = GGS_typeGalgas_bool::castFrom (inLexique, var_cas_expressionType.getPtr (), true, GGS_location (inLexique) COMMA_SOURCE_FILE_AT_LINE (384)) ;
        inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_then) COMMA_HERE) ;
        GGS_templateInstructionList  var_cas_instructionList = GGS_templateInstructionList ::constructor_emptyList () ;
        ::routine_enterTemplateStringEX (inLexique,  var_cas_instructionList COMMA_SOURCE_FILE_AT_LINE (387)) ;
        GGS_templateVariableMap  var_cas_templateVariableMap = var_cas_ioTemplateVariableMap ;
        { bool syntaxRepeat_12 = true ;
          while (syntaxRepeat_12) {
            switch (select_galgasTemplateParser_12 (inLexique)) {
              case 2 : {
                nt_template_5F_instruction_ (inLexique, var_cas_templateVariableMap, var_cas_inSemanticContext, var_cas_inComponentSemanticsEntitiesMap, var_cas_inOptionsComponentsMapForUse, var_cas_instructionList, var_cas_ioUsesColumnMarker) ;
                ::routine_enterTemplateStringEX (inLexique,  var_cas_instructionList COMMA_SOURCE_FILE_AT_LINE (399)) ;
                } break ;
              default :
                syntaxRepeat_12 = false ;
                break ;
            }
          }
        }
        var_cas_templateInstructionIfBranchList.addAssign_operation (var_cas_expression, var_cas_instructionList) ;
      switch (select_galgasTemplateParser_11 (inLexique)) {
        case 2 : {
          inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_elsif) COMMA_HERE) ;
          } break ;
        default :
          syntaxRepeat_11 = false ;
          break ;
      }
    }
  }
  GGS_templateInstructionList  var_cas_elseInstructionList = GGS_templateInstructionList ::constructor_emptyList () ;
  switch (select_galgasTemplateParser_13 (inLexique)) {
    case 1 : {
      } break ;
    case 2 : {
      inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_else) COMMA_HERE) ;
      ::routine_enterTemplateStringEX (inLexique,  var_cas_elseInstructionList COMMA_SOURCE_FILE_AT_LINE (410)) ;
      GGS_templateVariableMap  var_cas_templateVariableMap = var_cas_ioTemplateVariableMap ;
      { bool syntaxRepeat_14 = true ;
        while (syntaxRepeat_14) {
          switch (select_galgasTemplateParser_14 (inLexique)) {
            case 2 : {
              nt_template_5F_instruction_ (inLexique, var_cas_templateVariableMap, var_cas_inSemanticContext, var_cas_inComponentSemanticsEntitiesMap, var_cas_inOptionsComponentsMapForUse, var_cas_elseInstructionList, var_cas_ioUsesColumnMarker) ;
              ::routine_enterTemplateStringEX (inLexique,  var_cas_elseInstructionList COMMA_SOURCE_FILE_AT_LINE (422)) ;
              } break ;
            default :
              syntaxRepeat_14 = false ;
              break ;
          }
        }
      }
      } break ;
    default :
      break ;
  }
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_end) COMMA_HERE) ;
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_if) COMMA_HERE) ;
  var_cas_ioResultingInstructionList.addAssign_operation (GGS_templateInstructionIf ::constructor_new (inLexique, var_cas_templateInstructionIfBranchList, var_cas_elseInstructionList COMMA_SOURCE_FILE_AT_LINE (428))) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//         Implementation of production rule 'template_instruction'          *
//                                                                           *
//---------------------------------------------------------------------------*

void galgasTemplateParser::rule_galgasTemplateParser_template_5F_instruction_i7_ (C_Lexique_galgasTemplateScanner & inLexique,
                                GGS_templateVariableMap  &var_cas_ioTemplateVariableMap,
                                const GGS_EXsemanticContext var_cas_inSemanticContext,
                                const GGS_M_semanticsEntitiesForUse  var_cas_inComponentSemanticsEntitiesMap,
                                const GGS_M_optionComponents  var_cas_inOptionsComponentsMapForUse,
                                GGS_templateInstructionList  &var_cas_ioResultingInstructionList,
                                GGS_bool &var_cas_ioUsesColumnMarker) {
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_switch) COMMA_HERE) ;
  GGS_typeExpression  var_cas_switchExpression ;
  GGS_AC_galgasType  var_cas_switchExpressionType ;
  nt_expression_ (inLexique, var_cas_inComponentSemanticsEntitiesMap, var_cas_inSemanticContext, var_cas_inOptionsComponentsMapForUse, var_cas_ioTemplateVariableMap, var_cas_switchExpression, var_cas_switchExpressionType) ;
  GGS_typeGalgas_enum  var_cas_x = GGS_typeGalgas_enum::castFrom (inLexique, var_cas_switchExpressionType.getPtr (), true, GGS_location (inLexique) COMMA_SOURCE_FILE_AT_LINE (457)) ;
  const GGS_enumConstantMap  var_cas_enumConstantesMap = var_cas_x.reader_mEnumConstantesMap (inLexique COMMA_SOURCE_FILE_AT_LINE (458)) ;
  GGS_stringset  var_cas_namedConstantSet = GGS_stringset ::constructor_emptySet () ;
  GGS_templateInstructionSwitchBranchList  var_cas_templateInstructionSwitchBranchList = GGS_templateInstructionSwitchBranchList ::constructor_emptyList () ;
  { bool syntaxRepeat_15 = true ;
    while (syntaxRepeat_15) {
      switch (select_galgasTemplateParser_15 (inLexique)) {
        case 2 : {
          inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_when) COMMA_HERE) ;
          GGS_lstringlist  var_cas_constantList = GGS_lstringlist ::constructor_emptyList () ;
          { bool syntaxRepeat_16 = true ;
            while (syntaxRepeat_16) {
                GGS_lstring  var_cas_constantName ;
                inLexique.assignFromAttribute_tokenString (var_cas_constantName) ;
                inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_identifier) COMMA_HERE) ;
                GGS_uint  automatic_var_15709_0 ;
                if (var_cas_enumConstantesMap.isBuilt ()) {
                  var_cas_enumConstantesMap (HERE)->method_searchKey (inLexique, var_cas_constantName, automatic_var_15709_0 COMMA_SOURCE_FILE_AT_LINE (468)) ;
                }
                const GGS_bool cond_15874 = var_cas_namedConstantSet.reader_hasKey (var_cas_constantName.reader_string (inLexique COMMA_SOURCE_FILE_AT_LINE (469))) ;
                if (cond_15874.isBuiltAndTrue ()) {
                  var_cas_constantName.reader_location (inLexique COMMA_HERE).signalGGSSemanticError (inLexique, GGS_string ("this constant is already named in the switch instruction") COMMA_SOURCE_FILE_AT_LINE (471)) ;
                }
                var_cas_namedConstantSet.addAssign_operation (var_cas_constantName.reader_string (inLexique COMMA_SOURCE_FILE_AT_LINE (472))) ;
                var_cas_constantList.addAssign_operation (var_cas_constantName) ;
              switch (select_galgasTemplateParser_16 (inLexique)) {
                case 2 : {
                  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken__2C_) COMMA_HERE) ;
                  } break ;
                default :
                  syntaxRepeat_16 = false ;
                  break ;
              }
            }
          }
          inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken__3A_) COMMA_HERE) ;
          GGS_templateInstructionList  var_cas_instructionList = GGS_templateInstructionList ::constructor_emptyList () ;
          ::routine_enterTemplateStringEX (inLexique,  var_cas_instructionList COMMA_SOURCE_FILE_AT_LINE (479)) ;
          GGS_templateVariableMap  var_cas_templateVariableMap = var_cas_ioTemplateVariableMap ;
          { bool syntaxRepeat_17 = true ;
            while (syntaxRepeat_17) {
              switch (select_galgasTemplateParser_17 (inLexique)) {
                case 2 : {
                  nt_template_5F_instruction_ (inLexique, var_cas_templateVariableMap, var_cas_inSemanticContext, var_cas_inComponentSemanticsEntitiesMap, var_cas_inOptionsComponentsMapForUse, var_cas_instructionList, var_cas_ioUsesColumnMarker) ;
                  ::routine_enterTemplateStringEX (inLexique,  var_cas_instructionList COMMA_SOURCE_FILE_AT_LINE (491)) ;
                  } break ;
                default :
                  syntaxRepeat_17 = false ;
                  break ;
              }
            }
          }
          var_cas_templateInstructionSwitchBranchList.addAssign_operation (var_cas_constantList, var_cas_instructionList) ;
          } break ;
        default :
          syntaxRepeat_15 = false ;
          break ;
      }
    }
  }
  GGS_stringset  var_cas_missingConstants = var_cas_enumConstantesMap.reader_allKeys (inLexique COMMA_SOURCE_FILE_AT_LINE (496)).substract_operation (inLexique, var_cas_namedConstantSet COMMA_SOURCE_FILE_AT_LINE (496)) ;
  const GGS_bool cond_16932 = (var_cas_missingConstants.reader_count ()).operator_strictSup (GGS_uint (0U)) ;
  if (cond_16932.isBuiltAndTrue ()) {
    GGS_string var_cas_m = GGS_string ("the following constants are missing:") ;
    {
      GGS_stringset::cEnumerator enumerator_16849 (var_cas_missingConstants, true) ;
      while (enumerator_16849.hasCurrentObject ()) {
        var_cas_m.appendCString ("\n"
          "  - '") ;
        var_cas_m.dotAssign_operation (enumerator_16849._key (HERE)) ;
        var_cas_m.appendCString ("'") ;
        enumerator_16849.next () ;
      }
    }
    GGS_location (inLexique).reader_location (inLexique COMMA_HERE).signalGGSSemanticError (inLexique, var_cas_m COMMA_SOURCE_FILE_AT_LINE (503)) ;
  }
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_end) COMMA_HERE) ;
  inLexique.acceptTerminal (ACCEPT_TERMINAL (C_Lexique_galgasTemplateScanner::kToken_switch) COMMA_HERE) ;
  var_cas_ioResultingInstructionList.addAssign_operation (GGS_templateInstructionSwitch ::constructor_new (inLexique, var_cas_x.reader_mEnumTypeName (inLexique COMMA_SOURCE_FILE_AT_LINE (508)).reader_string (inLexique COMMA_SOURCE_FILE_AT_LINE (508)), var_cas_switchExpression, var_cas_templateInstructionSwitchBranchList COMMA_SOURCE_FILE_AT_LINE (507))) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//    Implementation of production rule 'lexique_component_start_symbol'     *
//                                                                           *
//---------------------------------------------------------------------------*

void galgasTemplateParser::rule_galgasTemplateParser_lexique_5F_component_5F_start_5F_symbol_i8_ (C_Lexique_galgasTemplateScanner & inLexique,
                                const GGS_templateVariableMap  var_cas_inTemplateVariableMap,
                                const GGS_EXsemanticContext var_cas_inSemanticContext,
                                const GGS_M_semanticsEntitiesForUse  var_cas_inComponentSemanticsEntitiesMap,
                                const GGS_M_optionComponents  var_cas_inOptionsComponentsMapForUse,
                                GGS_templateInstructionList  &var_cas_outResultingInstructionList,
                                GGS_bool &var_cas_outUsesColumnMarker) {
  var_cas_outResultingInstructionList = GGS_templateInstructionList ::constructor_emptyList () ;
  GGS_templateVariableMap  var_cas_templateVariableMap = var_cas_inTemplateVariableMap ;
  ::routine_enterTemplateStringEX (inLexique,  var_cas_outResultingInstructionList COMMA_SOURCE_FILE_AT_LINE (526)) ;
  var_cas_outUsesColumnMarker = GGS_bool (false) ;
  { bool syntaxRepeat_18 = true ;
    while (syntaxRepeat_18) {
      switch (select_galgasTemplateParser_18 (inLexique)) {
        case 2 : {
          nt_template_5F_instruction_ (inLexique, var_cas_templateVariableMap, var_cas_inSemanticContext, var_cas_inComponentSemanticsEntitiesMap, var_cas_inOptionsComponentsMapForUse, var_cas_outResultingInstructionList, var_cas_outUsesColumnMarker) ;
          ::routine_enterTemplateStringEX (inLexique,  var_cas_outResultingInstructionList COMMA_SOURCE_FILE_AT_LINE (538)) ;
          } break ;
        default :
          syntaxRepeat_18 = false ;
          break ;
      }
    }
  }
}

//---------------------------------------------------------------------------*

