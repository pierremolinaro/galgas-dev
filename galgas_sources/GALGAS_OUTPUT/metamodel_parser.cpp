//---------------------------------------------------------------------------*
//                                                                           *
//                       File 'metamodel_parser.cpp'                         *
//         Generated by version GALGAS_BETA_VERSION (LL(1) grammar)          *
//                      march 16th, 2006, at 22h9'14"                        *
//                                                                           *
//---------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

#include "utilities/MF_MemoryControl.h"
#include "files/C_TextFileWrite.h"
#include "metamodel_parser.h"


//--- START OF USER ZONE 2


//--- END OF USER ZONE 2

//---------------------------------------------------------------------------*
//                                                                           *
//           Implementation of production rule 'galgas_component'            *
//                                                                           *
//---------------------------------------------------------------------------*

void metamodel_parser::
pr_galgas_component_metamodel_parser_65_24_ (galgas_scanner & lexique_var_,
                                GGS_M_lexiqueComponents  &/* var_cas_ioLexiqueMapForUse */,
                                GGS_M_semanticsComponents  &/* var_cas_ioSemanticsComponentsMap */,
                                GGS_M_syntaxComponents  &/* var_cas_ioSyntaxComponentsMap */,
                                GGS_M_grammarComponents  &/* var_cas_ioGrammarComponentsMap */,
                                GGS_M_optionComponents  &/* var_cas_ioOptionsComponentsMap */) {
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  GGS_lstring  var_cas_metamodelName ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
  var_cas_metamodelName.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
  GGS_stringset  var_cas_primitiveTypeAttributeNameSet ;
  var_cas_primitiveTypeAttributeNameSet = GGS_stringset::constructor_empty (HERE) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "bool")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "char")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "uint")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "sint")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "double")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "string")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "lbool")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "lchar")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "luint")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "lsint")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "ldouble")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "lstring")) ;
  var_cas_primitiveTypeAttributeNameSet.addAssign_operation (GGS_string (true, "location")) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_root) ;
  GGS_lstring  var_cas_rootEntityName ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
  var_cas_rootEntityName.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3A) ;
  GGS_entityMap  var_cas_entityMap ;
  var_cas_entityMap = GGS_entityMap::constructor_empty (HERE) ;
  nt_entity_declaration_list_ (lexique_var_, var_cas_entityMap, var_cas_primitiveTypeAttributeNameSet) ;
  GGS_bool var_cas_isAbstract ;
  GGS_lstring  var_cas_4129 ;
  GGS_entityAttributeMap  var_cas_4132 ;
  GGS_entitySingleReferenceMap  var_cas_4135 ;
  GGS_entityMultipleReferenceMap  var_cas_4138 ;
  GGS_entityAttributeAndReferenceMap  var_cas_4141 ;
  var_cas_entityMap.methode_searchKey (lexique_var_, var_cas_rootEntityName, var_cas_isAbstract, var_cas_4129, var_cas_4132, var_cas_4135, var_cas_4138, var_cas_4141) ;
  if ((var_cas_isAbstract).isBuiltAndTrue ()) {
      var_cas_rootEntityName.reader_location ().signalGGSSemanticError (lexique_var_, GGS_string (true, "the root entity cannot be abstract")) ;
  }
  GGS_entityMap::element_type * operand_4310 = var_cas_entityMap.firstObject () ;
  while ((operand_4310 != NULL)) {
    macroValidPointer (operand_4310) ;
    GGS_entitySingleReferenceMap::element_type * operand_4649 = operand_4310->mInfo.mSingleReferenceMap.firstObject () ;
    while ((operand_4649 != NULL)) {
      macroValidPointer (operand_4649) ;
      GGS_bool var_cas_4743 ;
      GGS_lstring  var_cas_4746 ;
      GGS_entityAttributeMap  var_cas_4749 ;
      GGS_entitySingleReferenceMap  var_cas_4752 ;
      GGS_entityMultipleReferenceMap  var_cas_4755 ;
      GGS_entityAttributeAndReferenceMap  var_cas_4758 ;
      var_cas_entityMap.methode_searchKey (lexique_var_, operand_4649->mInfo.mSingleReferenceType, var_cas_4743, var_cas_4746, var_cas_4749, var_cas_4752, var_cas_4755, var_cas_4758) ;
      operand_4649 = operand_4649->nextObject () ;
    }
    GGS_entityMultipleReferenceMap::element_type * operand_4813 = operand_4310->mInfo.mMultipleReferenceMap.firstObject () ;
    while ((operand_4813 != NULL)) {
      macroValidPointer (operand_4813) ;
      GGS_bool var_cas_4911 ;
      GGS_lstring  var_cas_4914 ;
      GGS_entityAttributeMap  var_cas_4917 ;
      GGS_entitySingleReferenceMap  var_cas_4920 ;
      GGS_entityMultipleReferenceMap  var_cas_4923 ;
      GGS_entityAttributeAndReferenceMap  var_cas_4926 ;
      var_cas_entityMap.methode_searchKey (lexique_var_, operand_4813->mInfo.mMultipleReferenceType, var_cas_4911, var_cas_4914, var_cas_4917, var_cas_4920, var_cas_4923, var_cas_4926) ;
      operand_4813 = operand_4813->nextObject () ;
    }
    operand_4310 = operand_4310->nextObject () ;
  }
  if (var_cas_entityMap.isBuilt () &&
      var_cas_metamodelName.isBuilt ()) {
    ::routine_generate_metamodel (lexique_var_,  var_cas_entityMap,  var_cas_metamodelName) ;
  }
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_end) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
}

//---------------------------------------------------------------------------*

void metamodel_parser::
pr_galgas_component_metamodel_parser_65_24_importLexique (galgas_scanner & lexique_var_,
                                GGS_M_lexiqueComponents  &/* var_cas_ioLexiqueMapForUse */) {
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_root) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3A) ;
  nt_entity_declaration_list_parse (lexique_var_) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_end) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
}

//---------------------------------------------------------------------------*

void metamodel_parser::
pr_galgas_component_metamodel_parser_65_24_importSyntax (galgas_scanner & lexique_var_,
                                GGS_M_syntaxComponents  &/* var_cas_ioSyntaxComponentsMap */) {
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_root) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3A) ;
  nt_entity_declaration_list_parse (lexique_var_) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_end) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
}

//---------------------------------------------------------------------------*

void metamodel_parser::
pr_galgas_component_metamodel_parser_65_24_importSemantics (galgas_scanner & lexique_var_,
                                GGS_M_semanticsComponents  &/* var_cas_ioSemanticsComponentsMap */) {
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_root) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3A) ;
  nt_entity_declaration_list_parse (lexique_var_) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_end) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
}

//---------------------------------------------------------------------------*

void metamodel_parser::
pr_galgas_component_metamodel_parser_65_24_importGrammarForSemantics (galgas_scanner & lexique_var_,
                                GGS_M_grammarComponents  &/* var_cas_ioGrammarComponentsMap */) {
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_root) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3A) ;
  nt_entity_declaration_list_parse (lexique_var_) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_end) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
}

//---------------------------------------------------------------------------*

void metamodel_parser::
pr_galgas_component_metamodel_parser_65_24_importOptions (galgas_scanner & lexique_var_,
                                GGS_M_optionComponents  &/* var_cas_ioOptionsComponentsMap */) {
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_root) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3A) ;
  nt_entity_declaration_list_parse (lexique_var_) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_end) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_metamodel) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//       Implementation of production rule 'entity_declaration_list'         *
//                                                                           *
//---------------------------------------------------------------------------*

void metamodel_parser::
pr_entity_declaration_list_metamodel_parser_189_31_ (galgas_scanner & lexique_var_,
                                GGS_entityMap  &var_cas_outEntityMap,
                                GGS_stringset  &var_cas_ioPrimitiveTypeAttributeNameSet) {
  var_cas_outEntityMap = GGS_entityMap::constructor_empty (HERE) ;
  { bool syntaxRepeat = true ;
    while (syntaxRepeat) {
      switch (select_repeat_metamodel_parser_0 (lexique_var_)) {
        case 2 : {
          nt_entity_declaration_ (lexique_var_, var_cas_outEntityMap, var_cas_ioPrimitiveTypeAttributeNameSet) ;
          } break ;
        default :
          syntaxRepeat = false ;
          break ;
      }
    }
  }
}

//---------------------------------------------------------------------------*

void metamodel_parser::
pr_entity_declaration_list_metamodel_parser_189_31_parse (galgas_scanner & lexique_var_) {
  { bool syntaxRepeat = true ;
    while (syntaxRepeat) {
      switch (select_repeat_metamodel_parser_0 (lexique_var_)) {
        case 2 : {
          nt_entity_declaration_parse (lexique_var_) ;
          } break ;
        default :
          syntaxRepeat = false ;
          break ;
      }
    }
  }
}

//---------------------------------------------------------------------------*
//                                                                           *
//          Implementation of production rule 'entity_declaration'           *
//                                                                           *
//---------------------------------------------------------------------------*

void metamodel_parser::
pr_entity_declaration_metamodel_parser_205_26_ (galgas_scanner & lexique_var_,
                                GGS_entityMap  &var_cas_ioEntityMap,
                                GGS_stringset  &var_cas_ioPrimitiveTypeAttributeNameSet) {
  GGS_bool var_cas_isAbstract ;
  switch (select_metamodel_parser_1 (lexique_var_)) {
    case 1 : {
      var_cas_isAbstract = GGS_bool (true, false) ;
      } break ;
    case 2 : {
      lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_abstract) ;
      var_cas_isAbstract = GGS_bool (true, true) ;
      } break ;
    default :
      break ;
  }
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_entity) ;
  GGS_lstring  var_cas_entityName ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
  var_cas_entityName.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
  GGS_entityAttributeMap  var_cas_entityAttributeMap ;
  GGS_entitySingleReferenceMap  var_cas_singleReferenceMap ;
  GGS_entityMultipleReferenceMap  var_cas_multipleReferenceMap ;
  GGS_entityAttributeAndReferenceMap  var_cas_m ;
  GGS_lstring  var_cas_superEntity ;
  switch (select_metamodel_parser_2 (lexique_var_)) {
    case 1 : {
      var_cas_superEntity = GGS_lstring::constructor_new (GGS_string (true, ""), GGS_location (lexique_var_) COMMA_HERE) ;
      var_cas_entityAttributeMap = GGS_entityAttributeMap::constructor_empty (HERE) ;
      var_cas_singleReferenceMap = GGS_entitySingleReferenceMap::constructor_empty (HERE) ;
      var_cas_multipleReferenceMap = GGS_entityMultipleReferenceMap::constructor_empty (HERE) ;
      var_cas_m = GGS_entityAttributeAndReferenceMap::constructor_empty (HERE) ;
      } break ;
    case 2 : {
      lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_extends) ;
      lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
      var_cas_superEntity.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
      GGS_bool var_cas_7557 ;
      GGS_lstring  var_cas_7560 ;
      var_cas_ioEntityMap.methode_searchKey (lexique_var_, var_cas_superEntity, var_cas_7557, var_cas_7560, var_cas_entityAttributeMap, var_cas_singleReferenceMap, var_cas_multipleReferenceMap, var_cas_m) ;
      } break ;
    default :
      break ;
  }
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__7B) ;
  { bool syntaxRepeat = true ;
    while (syntaxRepeat) {
      switch (select_repeat_metamodel_parser_3 (lexique_var_)) {
        case 2 : {
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_attribute) ;
          GGS_lstring  var_cas_attributeTypeName ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
          var_cas_attributeTypeName.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
          if (((! var_cas_ioPrimitiveTypeAttributeNameSet.reader_hasKey (var_cas_attributeTypeName.reader_value ()))).isBuiltAndTrue ()) {
              var_cas_attributeTypeName.reader_location ().signalGGSSemanticError (lexique_var_, ((((GGS_string (true, "the '@")) + (var_cas_attributeTypeName.reader_value ()))) + (GGS_string (true, "' is not a predefined attribute type")))) ;
          }
          GGS_lstring  var_cas_attributeName ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
          var_cas_attributeName.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
          var_cas_m.methode_insertKey (lexique_var_, var_cas_attributeName) ;
          var_cas_entityAttributeMap.methode_insertKey (lexique_var_, var_cas_attributeName, var_cas_attributeTypeName) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
          } break ;
        case 3 : {
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_ref) ;
          GGS_lstring  var_cas_referenceEntityName ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
          var_cas_referenceEntityName.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
          GGS_lstring  var_cas_referenceName ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
          var_cas_referenceName.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
          var_cas_m.methode_insertKey (lexique_var_, var_cas_referenceName) ;
          var_cas_singleReferenceMap.methode_insertKey (lexique_var_, var_cas_referenceName, var_cas_referenceEntityName) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
          } break ;
        case 4 : {
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_list) ;
          GGS_lstring  var_cas_entityName ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
          var_cas_entityName.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
          GGS_lstring  var_cas_referenceName ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
          var_cas_referenceName.defineAttribute (lexique_var_.tokenString, lexique_var_) ;
          var_cas_m.methode_insertKey (lexique_var_, var_cas_referenceName) ;
          var_cas_multipleReferenceMap.methode_insertKey (lexique_var_, var_cas_referenceName, var_cas_entityName) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
          } break ;
        default :
          syntaxRepeat = false ;
          break ;
      }
    }
  }
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__7D) ;
  var_cas_ioEntityMap.methode_insertKey (lexique_var_, var_cas_entityName, var_cas_isAbstract, var_cas_superEntity, var_cas_entityAttributeMap, var_cas_singleReferenceMap, var_cas_multipleReferenceMap, var_cas_m) ;
}

//---------------------------------------------------------------------------*

void metamodel_parser::
pr_entity_declaration_metamodel_parser_205_26_parse (galgas_scanner & lexique_var_) {
  switch (select_metamodel_parser_1 (lexique_var_)) {
    case 1 : {
      } break ;
    case 2 : {
      lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_abstract) ;
      } break ;
    default :
      break ;
  }
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_entity) ;
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
  switch (select_metamodel_parser_2 (lexique_var_)) {
    case 1 : {
      } break ;
    case 2 : {
      lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_extends) ;
      lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
      } break ;
    default :
      break ;
  }
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__7B) ;
  { bool syntaxRepeat = true ;
    while (syntaxRepeat) {
      switch (select_repeat_metamodel_parser_3 (lexique_var_)) {
        case 2 : {
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_attribute) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
          } break ;
        case 3 : {
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_ref) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
          } break ;
        case 4 : {
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_list) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_type_5Fname) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1_identifier) ;
          lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__3B) ;
          } break ;
        default :
          syntaxRepeat = false ;
          break ;
      }
    }
  }
  lexique_var_.acceptTerminal (galgas_scanner::galgas_scanner_1__7D) ;
}

//---------------------------------------------------------------------------*

