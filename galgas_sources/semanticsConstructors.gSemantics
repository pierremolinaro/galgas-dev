#---------------------------------------------------------------------------*
#                                                                           *
#  Type constructors                                                        *
#                                                                           *
#  Copyright (C) 2009, ..., 2014 Pierre Molinaro.                           *
#  e-mail : molinaro@irccyn.ec-nantes.fr                                    *
#                                                                           *
#  This program is free software; you can redistribute it and/or modify it  *
#  under the terms of the GNU General Public License as published by the    *
#  Free Software Foundation.                                                *
#                                                                           *
#  This program is distributed in the hope it will be useful, but WITHOUT   *
#  ANY WARRANTY; without even the implied warranty of MERCHANDIBILITY or    *
#  FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for *
#   more details.                                                           *
#                                                                           *
#---------------------------------------------------------------------------*

semantics semanticsConstructors :
  import "semanticsTypes.gSemantics" ;

#---------------------------------------------------------------------------*

routine enterConstructorWithoutArgument
  ?!@constructorMap ioConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  ??@string inConstructorName
  ??@string inReturnedTypeName
  ??@bool inHasLexiqueAndLocationArguments
:
  [@unifiedTypeMapProxy makeProxyFromString
    !?ioUnifiedTypeMap
    !inReturnedTypeName
    ??@unifiedTypeMapProxy returnedTypeIndex
  ] ;
  [!?ioConstructorMap insertOrReplace
    ![@lstring new !inConstructorName !here]
    ![@unifiedTypeMapProxyAndParameterList emptyList]
    !inHasLexiqueAndLocationArguments
    !returnedTypeIndex
  ] ;
end routine ;

#---------------------------------------------------------------------------*

routine enterConstructorWithArgument
  ?!@constructorMap ioConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  ??@string inConstructorName
  ??@string inArgument1TypeName
  ??@string inArgument1Name
  ??@string inReturnedTypeName
  ??@bool inHasLexiqueAndLocationArguments
:
  @unifiedTypeMapProxy returnedTypeIndex ;
  [@unifiedTypeMapProxy makeProxyFromString !?ioUnifiedTypeMap !inReturnedTypeName ?returnedTypeIndex] ;
  @unifiedTypeMapProxy t ;
  [@unifiedTypeMapProxy makeProxyFromString !?ioUnifiedTypeMap !inArgument1TypeName ?t] ;
  [!?ioConstructorMap insertOrReplace
    ![@lstring new !inConstructorName !here]
    ![@unifiedTypeMapProxyAndParameterList listWithValue !t !inArgument1Name]
    !inHasLexiqueAndLocationArguments
    !returnedTypeIndex
  ] ;
end routine ;

#---------------------------------------------------------------------------*

routine enterConstructorWith2Arguments
  ?!@constructorMap ioConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  ??@string inConstructorName
  ??@string inArgument1TypeName
  ??@string inArgument1Name
  ??@string inArgument2TypeName
  ??@string inArgument2Name
  ??@string inReturnedTypeName
  ??@bool inHasLexiqueAndLocationArguments
:
  @unifiedTypeMapProxy returnedTypeIndex ;
  [@unifiedTypeMapProxy makeProxyFromString !?ioUnifiedTypeMap !inReturnedTypeName ?returnedTypeIndex] ;
  @unifiedTypeMapProxyAndParameterList argumentTypeList [emptyList] ;
  @unifiedTypeMapProxy t ;
  [@unifiedTypeMapProxy makeProxyFromString !?ioUnifiedTypeMap !inArgument1TypeName ?t] ;
  argumentTypeList += !t !inArgument1Name ;
  [@unifiedTypeMapProxy makeProxyFromString !?ioUnifiedTypeMap !inArgument2TypeName ?t] ;
  argumentTypeList += !t !inArgument2Name ;
  [!?ioConstructorMap insertOrReplace
    ![@lstring new !inConstructorName !here]
    !argumentTypeList
    !inHasLexiqueAndLocationArguments
    !returnedTypeIndex
  ] ;
end routine ;

#---------------------------------------------------------------------------*

routine enterConstructorWith3Arguments
  ?!@constructorMap ioConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  ??@string inConstructorName
  ??@string inArgument1TypeName
  ??@string inArgument1Name
  ??@string inArgument2TypeName
  ??@string inArgument2Name
  ??@string inArgument3TypeName
  ??@string inArgument3Name
  ??@string inReturnedTypeName
  ??@bool inHasLexiqueAndLocationArguments
:
  @unifiedTypeMapProxy returnedTypeIndex ;
  [@unifiedTypeMapProxy makeProxyFromString !?ioUnifiedTypeMap !inReturnedTypeName ?returnedTypeIndex] ;
  @unifiedTypeMapProxy t ;
  [@unifiedTypeMapProxy makeProxyFromString !?ioUnifiedTypeMap !inArgument1TypeName ?t] ;
  @unifiedTypeMapProxyAndParameterList argumentTypeList [emptyList] ;
  argumentTypeList += !t !inArgument1Name ;
  [@unifiedTypeMapProxy makeProxyFromString !?ioUnifiedTypeMap !inArgument2TypeName ?t] ;
  argumentTypeList += !t !inArgument2Name ;
  [@unifiedTypeMapProxy makeProxyFromString !?ioUnifiedTypeMap !inArgument3TypeName ?t] ;
  argumentTypeList += !t !inArgument3Name ;
  [!?ioConstructorMap insertOrReplace
    ![@lstring new !inConstructorName !here]
    !argumentTypeList
    !inHasLexiqueAndLocationArguments
    !returnedTypeIndex
  ] ;
end routine ;

#---------------------------------------------------------------------------*

override method @locationPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"nowhere" !"location" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @stringPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"retrieveAndResetTemplateString" !"string" !true ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"stringWithSymbolicLinkContents" !"string" !"inPath" !"string" !true ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"stringWithVersionString" !"string" !false ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"stringWithSourceFilePath" !"string" !true ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"stringWithCurrentDirectory" !"string" !false ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"stringWithMainFirstArgument" !"string" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"stringWithContentsOfFile" !"string" !"inFilePath" !"string" !true ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"stringWithCurrentDateTime" !"string" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"stringWithEnvironmentVariable" !"string" !"inEnvironmentVariable" !"string" !true ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"stringWithEnvironmentVariableOrEmpty" !"string" !"inEnvironmentVariable" !"string" !false ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"CppLineComment" !"string" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"CppTitleComment" !"string" !"inString" !"string" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"CppString" !"string" !"inString" !"string" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"CppChar" !"char" !"inChar" !"string" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"componentsJoinedByString" !"stringlist" !"inComponents" !"string" !"inString" !"string" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"stringWithSequenceOfCharacters" !"char" !"inChar" !"uint" !"inCount" !"string" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @applicationPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
#--- Constructors for "bool" options
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"boolOptionNameList" !"2stringlist" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"boolOptionInvocationLetter" !"string" !"inOptionComponentName" !"string" !"inOptionName" !"char" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"boolOptionInvocationString" !"string" !"inOptionComponentName" !"string" !"inOptionName" !"string" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"boolOptionCommentString" !"string" !"inOptionComponentName" !"string" !"inOptionName" !"string" !false ;
#--- Constructors for "uint" options
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"uintOptionNameList" !"2stringlist" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"uintOptionInvocationLetter" !"string" !"inOptionComponentName" !"string" !"inOptionName" !"char" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"uintOptionInvocationString" !"string" !"inOptionComponentName" !"string" !"inOptionName" !"string" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"uintOptionCommentString" !"string" !"inOptionComponentName" !"string" !"inOptionName" !"string" !false ;
#--- Constructors for "string" options
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"stringOptionNameList" !"2stringlist" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"stringOptionInvocationLetter" !"string" !"inOptionComponentName" !"string" !"inOptionName" !"char" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"stringOptionInvocationString" !"string" !"inOptionComponentName" !"string" !"inOptionName" !"string" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"stringOptionCommentString" !"string" !"inOptionComponentName" !"string" !"inOptionName" !"string" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @charPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"replacementCharacter" !"char" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"unicodeCharacterWithUnsigned" !"uint" !"inValue" !"char" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @uintPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"compilationMode" !"uint" !false ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"max" !"uint" !false ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"errorCount" !"uint" !false ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"warningCount" !"uint" !false ;
  enterConstructorWith2Arguments !?outMap !?ioUnifiedTypeMap !"valueWithMask" !"uint" !"inLowerIndex" !"uint" !"inUpperIndex" !"uint" !true ;
end method ;

#---------------------------------------------------------------------------*

override method @sintPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"max" !"sint" !false ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"min" !"sint" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @uint64PredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"max" !"uint64" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"uint64MaskWithCompressedBitString" !"string" !"inBitString" !"uint64" !true ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"uint64BaseValueWithCompressedBitString" !"string" !"inBitString" !"uint64" !true ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"uint64WithBitString" !"string" !"inBitString" !"uint64" !true ;
end method ;

#---------------------------------------------------------------------------*

override method @sint64PredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"max" !"sint64" !false ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"min" !"sint64" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @stringsetPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"emptySet" !"stringset" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"setWithString" !"string" !"inString" !"stringset" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"setWithStringList" !"stringlist" !"inStringList" !"stringset" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"setWithLStringList" !"lstringlist" !"inLStringList" !"stringset" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @binarysetPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"binarySetWithBit" !"uint" !"inBitIndex" !"binaryset" !true ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"emptyBinarySet" !"binaryset" !false ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"fullBinarySet" !"binaryset" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"binarySetWithPredicateString" !"string" !"inPredicateString" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithNotEqualComparison" !"uint" !"inLeftFirstIndex" !"uint" !"inBitCount" !"uint" !"inRightFirstIndex" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithEqualComparison" !"uint" !"inLeftFirstIndex" !"uint" !"inBitCount" !"uint" !"inRightFirstIndex" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithStrictLowerComparison" !"uint" !"inLeftFirstIndex" !"uint" !"inBitCount" !"uint" !"inRightFirstIndex" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithStrictGreaterComparison" !"uint" !"inLeftFirstIndex" !"uint" !"inBitCount" !"uint" !"inRightFirstIndex" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithLowerOrEqualComparison" !"uint" !"inLeftFirstIndex" !"uint" !"inBitCount" !"uint" !"inRightFirstIndex" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithGreaterOrEqualComparison" !"uint" !"inLeftFirstIndex" !"uint" !"inBitCount" !"uint" !"inRightFirstIndex" !"binaryset"  !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithEqualToConstant" !"uint" !"inBitIndex" !"uint" !"inBitCount" !"uint64" !"inConstant" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithNotEqualToConstant" !"uint" !"inBitIndex" !"uint" !"inBitCount" !"uint64" !"inConstant" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithStrictLowerThanConstant" !"uint" !"inBitIndex" !"uint" !"inBitCount" !"uint64" !"inConstant" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithStrictGreaterThanConstant" !"uint" !"inBitIndex" !"uint" !"inBitCount" !"uint64" !"inConstant" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithLowerOrEqualToConstant" !"uint" !"inBitIndex" !"uint" !"inBitCount" !"uint64" !"inConstant" !"binaryset" !true ;
  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithGreaterOrEqualToConstant" !"uint" !"inBitIndex" !"uint" !"inBitCount" !"uint64" !"inConstant" !"binaryset" !true ;
#  enterConstructorWith3Arguments !?outMap !?ioUnifiedTypeMap !"binarySetWithITE" !"binaryset" !"binaryset" !"binaryset" !"binaryset" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @typePredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"typeList" !"typelist" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @dataPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"emptyData" !"data" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"dataWithContentsOfFile" !"string" !"inFilePath" !"data" !true ;
end method ;

#---------------------------------------------------------------------------*

override method @functionPredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"functionList" !"functionlist" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"functionWithName" !"string" !"inName" !"function" !false ;
  enterConstructorWithArgument !?outMap !?ioUnifiedTypeMap !"isFunctionDefined" !"string" !"inFunctionName" !"bool" !false ;
end method ;

#---------------------------------------------------------------------------*

override method @doublePredefinedTypeAST getConstructorMap
  ?!@unifiedTypeMap ioUnifiedTypeMap
  !@constructorMap outMap
:
  outMap := [@constructorMap emptyMap] ;
  enterConstructorWithoutArgument !?outMap !?ioUnifiedTypeMap !"pi" !"double" !false ;
  enterConstructorWithArgument    !?outMap !?ioUnifiedTypeMap !"doubleWithBinaryImage" !"uint64" !"inBinaryImage" !"double" !false ;
end method ;

#---------------------------------------------------------------------------*

end semantics ;
